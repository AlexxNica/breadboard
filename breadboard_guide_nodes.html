<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Breadboard: Nodes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,700" rel="stylesheet">
<link href="style.css" rel="stylesheet" type="text/css"/>
<script>
  /**
   * Check if the browser rendering this page is being run on an Android device.
   * It checks if the string 'android' is found in the browser's `userAgent`.
   * @return {boolean} This returns `true` if the browser's `userAgent` contains
   * the string 'android' (indicating that the browser is on an Android device).
   * Otherwise, it returns `false`.
   */
  function isAndroidDevice() {
    if (navigator && navigator.userAgent) {
      return navigator.userAgent.toLowerCase().indexOf('android') != -1;
    } else {
      return false;
    }
  }
  /**
   * Check if an HTML `class` attribute is in the browser-specific format.
   * @param {string} An HTML `class` attribute in the format 'browser-{device}'.
   * @return {boolean} Returns `true` if `browserClass` was in the valid format,
   * prefixed with 'browser-'. Otherwise, it returns false.
   */
  function isBrowserSpecificClassName(browserClass) {
    if (browserClass && browserClass.substring(0, 8) == 'browser-' &&
        browserClass.length > 8) {
      return true;
    } else {
      return false;
    }
  }
  /**
   * Get all the HTML Elements with browser-specific `class` attributes.
   * @return {array} Returns an array of all the HTML Elements with a `class`
   * attribute that is prefixed with `browser-`.
   */
  function getAllBrowserSpecificElements() {
    if (document) {
      var htmlElements = document.getElementsByTagName("*");
      var browserSpecificElements = [];
      for (var i = 0; i < htmlElements.length; i++) {
        if (isBrowserSpecificClassName(htmlElements[i].className)) {
          browserSpecificElements.push(htmlElements[i]);
        }
      }
      return browserSpecificElements;
    } else {
      return null;
    }
  }
  /**
   * Given a browser-specific HTML `class` attribute, extract the device name.
   * @param {string} browserClass The string name of an HTML `class` attribute,
   * in the format `browser-{device}`.
   * @return {string} Returns a string containing only the device portion of
   * the class name. If the input was invalid, then it returns `null`.
   */
  function extractDeviceFromBrowserClass(browserClass) {
    if (isBrowserSpecificClassName(browserClass)) {
      return browserClass.substring(8);
    }
    else {
      return null;
    }
  }
  /**
   * Hide device specific elements that do not apply to the current device.
   */
  function handleDeviceSpecificLoading() {
    var browserSpecificElements = getAllBrowserSpecificElements();
    for (var i = 0; i < browserSpecificElements.length; i++) {
      var device = extractDeviceFromBrowserClass(browserSpecificElements[i].className);
      if (device && !isAndroidDevice() && device == 'android') {
        browserSpecificElements[i].innerHTML = '';
      } else if(device && isAndroidDevice() && device == 'desktop') {
        browserSpecificElements[i].innerHTML = '';
      }
    }
  }
  $(document).ready(handleDeviceSpecificLoading);
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="commonprojectlogo">
    <img alt="Logo" src="fpl_logo_small.png"/>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Breadboard
   </div>
   <div style="font-size:12px;">
	 An open source project by
     <a href="https://developers.google.com/games/#Tools">FPL</a>.
  </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="breadboard_guide_overview.html"><span>Programmer's&#160;Guide</span></a></li>
      <li><a href="breadboard_api_reference.html"><span>API&#160;Reference</span></a></li>
      <li><a href="breadboard_readme.html"><span>Readme</span></a></li>
      <li><a href="contributing.html"><span>Contributing</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('breadboard_guide_nodes.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Nodes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview</h2>
<p>Nodes are the basic building blocks of a graph. Most nodes define an <code>Execute</code> function in C++ code which can take any number of arguments, process them, and then provide any number of outputs which other nodes may then consume.</p>
<h2>Basic Example</h2>
<p>As a simple example, see <code>src/modules/string.cpp</code>. This file defines the node ConcatNode, shown below:</p>
<div class="fragment"><div class="line"><span class="comment">// Concatenates the given strings.</span></div>
<div class="line"><span class="keyword">class </span>ConcatNode : <span class="keyword">public</span> BaseNode {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> ~ConcatNode() {}</div>
<div class="line"></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> OnRegister(NodeSignature* node_sig) {</div>
<div class="line">    node_sig-&gt;AddInput&lt;std::string&gt;();</div>
<div class="line">    node_sig-&gt;AddInput&lt;std::string&gt;();</div>
<div class="line">    node_sig-&gt;AddOutput&lt;std::string&gt;();</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Execute(NodeArguments* args) {</div>
<div class="line">    <span class="keyword">auto</span> str_a = args-&gt;GetInput&lt;std::string&gt;(0);</div>
<div class="line">    <span class="keyword">auto</span> str_b = args-&gt;GetInput&lt;std::string&gt;(1);</div>
<div class="line">    args-&gt;SetOutput(0, *str_a + *str_b);</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p>When this node is registered with Breadboard, it's OnRegister function is run. OnRegister is given a NodeSignature object that is used to define the number of inputs and outputs to this node. In this example, two <code>std::string</code> inputs and a single string output are declared.</p>
<p>Execute is where the behavior for this node is run. In this example, our node takes its two inputs by calling <code>args-&gt;GetInput&lt;std::string&gt;(index);</code>. This function returns the value in the input edge by pointer. When writing nodes you must take care to match the expected return type for the given edge index with the signature defined in OnRegister or else the call to <code>GetInput</code> will assert.</p>
<p>Finally, the result of the operation (in this case, concatenating two strings) is passed to <code>args-&gt;SetOutput</code>. In this case there is only a single output, so we pass 0 as the first argument, but if there were additional outputs we might also pass values to other indexes as well. As with input edges, make sure that the type being passed in matches the type declared in the NodeSignature in OnRegister.</p>
<p>In some cases you don't need to pass data around but you still want to trigger execution of a node. This can be achieved by assigning inputs or outputs with the type <code>void</code>. Rather than getting a pointer to the value using <code>args-&gt;GetInput&lt;void&gt;(index)</code>, you would simply call <code>args-&gt;IsInputDirty(index)</code> (Note: This function can be used on input edges of any type). For output edges that are declared void, simple call <code>args-&gt;SetOutput(index)</code> without a value argument to mark it as dirty.</p>
<h2>Node Inputs</h2>
<p>Node inputs can be specified in two ways: Either by pointing at the output of some other node, or by supplying a default value.</p>
<h2>Node Execution</h2>
<p>Nodes have three main functions declared on BaseNode. You will always need to implement OnRegister to define your node's interface. You may additionally override the <code>Initialize</code> and <code>Execute</code> functions. Without implementing at least one of these functions, your node will do nothing.</p>
<p>Nodes execute if one of two conditions is met.</p>
<ul>
<li>The node has a NodeEventListener associated with it, and an event that the node is listening for has been broadcast.</li>
<li>As a result of another executing, one of the input edges on this node has been updated.</li>
</ul>
<p>Any time an input edge of a node is changed as the result of a call to SetOutput it is considered dirty, and will have its Evaluate function called.</p>
<h2>BaseNode interface</h2>
<h3>OnRegister</h3>
<p>OnRegister is a static method, but it must be defined for your type. You do not technically override it, but you must still supply a copy of this function. OnRegister is called automatically when your node is registered with a Module.</p>
<h3>Initialize</h3>
<p>Initialize is called once when the GraphState itself is initialized. This can be a useful place to do any special set up for your node, or to set the value of output edges that only need to be set once and will never change. Initialize recieves a NodeArguments structure containing the default values for the inputs. You may set outputs as well from Initialize, but during the initialization step nodes that depend on those outputs are not marked as dirty.</p>
<h3>Execute</h3>
<p>Execute is where most of the heavy lifting will be done. This would be where you implement most behaviors. Using the NodeArguments structure you can get any values your node needs to operate and perform actions such as updating UI, playing audio, printing debug logs to the console, or responding to phsyics events. Nodes can be set up for just about any type of behavior that would want to script.</p>
<h2>Node Registration</h2>
<p>To register a node so that it can be used by Breadboard, simply call <code>Module::RegisterNode&lt;NodeType&gt;(name)</code>. You must specify a node name that is unique to this module.</p>
<p>By default, when constructing nodes the default constructor is used. However, this is not always ideal (or possible). In these cases, you may additionally provide custom constructor and destuctor callbacks.</p>
<p>For example, if you are writing a PlaySound node that requires a pointer to the audio engine, you could write it like this:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>PlaySoundNode : <span class="keyword">public</span> BaseNode {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  PlaySoundNode(AudioEngine* audio_engine) : audio_engine_(audio_engine) {}</div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line"></div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  AudioEngine* audio_engine_;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> InitializeAudioModule(ModuleRegistry* module_registry,</div>
<div class="line">                           AudioEngine* audio_engine) {</div>
<div class="line">  Module* module = module_registry-&gt;RegisterModule(<span class="stringliteral">&quot;audio&quot;</span>);</div>
<div class="line">  <span class="comment">// Custom constructor for PlaySoundNode since it cannot be constructed</span></div>
<div class="line">  <span class="comment">// with the default constructor.</span></div>
<div class="line">  <span class="keyword">auto</span> play_sound_ctor = [audio_engine]() {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">new</span> PlaySoundNode(audio_engine);</div>
<div class="line">  };</div>
<div class="line">  module-&gt;RegisterNode&lt;PlaySoundNode&gt;(<span class="stringliteral">&quot;play_sound&quot;</span>, play_sound_ctor);</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-49880327-7', 'google.github.io');
ga('send', 'pageview');
</script>
</body>
</html>
